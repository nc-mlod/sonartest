pipeline {
    agent any

    stages {
        stage('Build and Test') {
            steps {
                // Pobierz zależności, skompiluj, wykonaj testy i wygeneruj pliki .exec JaCoCo
                sh 'mvn clean jacoco:prepare-agent install jacoco:report'
            }
        }

        stage('JaCoCo') {
            steps {
                // Utwórz raport JaCoCo
                jacoco(execPattern: '**/target/jacoco.exec',
                        exclusionPattern: '**/controller/**,**/com/**')
            }
        }
    }
}